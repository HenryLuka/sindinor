import{A as s}from"./api-DsV8Zstu.js";class u{static readFileAsBase64(e){return new Promise((r,i)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=t=>{const o=new Image;o.src=t.target.result,o.onload=()=>{let a=o.width,d=o.height;a>d?a>800&&(d*=800/a,a=800):d>800&&(a*=800/d,d=800);const m=document.createElement("canvas");m.width=a,m.height=d,m.getContext("2d").drawImage(o,0,0,a,d),r(m.toDataURL("image/jpeg",.7))},o.onerror=l=>i(l)},n.onerror=t=>i(t)})}static init(){var e,r,i,n;window.checkAuth=()=>this.checkAuth(),window.logout=()=>this.logout(),localStorage.getItem("sindinor_admin_logged")==="true"&&this.showAdminPanel(),window.switchTab=t=>this.switchTab(t),window.deleteNews=t=>this.deleteNews(t),window.deletePartner=t=>this.deletePartner(t),window.deleteService=t=>this.deleteService(t),window.deleteDirector=t=>this.deleteDirector(t),(e=document.getElementById("news-form"))==null||e.addEventListener("submit",t=>this.handleAddNews(t)),(r=document.getElementById("partner-form"))==null||r.addEventListener("submit",t=>this.handleAddPartner(t)),(i=document.getElementById("service-form"))==null||i.addEventListener("submit",t=>this.handleAddService(t)),(n=document.getElementById("director-form"))==null||n.addEventListener("submit",t=>this.handleAddDirector(t))}static checkAuth(){document.getElementById("admin-pass").value==="admin123"?(localStorage.setItem("sindinor_admin_logged","true"),this.showAdminPanel()):alert("Senha incorreta!")}static showAdminPanel(){document.getElementById("auth-overlay").style.display="none",document.getElementById("admin-content").style.display="flex",this.loadData()}static logout(){localStorage.removeItem("sindinor_admin_logged"),location.reload()}static switchTab(e){document.querySelectorAll(".tab-content").forEach(i=>{i.classList.add("hidden"),i.classList.remove("active")}),document.querySelectorAll(".nav-btn").forEach(i=>i.classList.remove("active")),document.getElementById(`tab-${e}`).classList.remove("hidden"),document.getElementById(`tab-${e}`).classList.add("active");const r=document.querySelector(`button[onclick="switchTab('${e}')"]`);r&&r.classList.add("active")}static async loadData(){const e=await s.getNews(),r=document.getElementById("news-list");r&&(r.innerHTML="",e.forEach(a=>{r.innerHTML+=`
                    <div class="bg-secondary-dark border border-glass-border p-4 rounded-lg flex justify-between items-center group hover:border-accent-cyan transition-colors">
                        <div>
                            <h4 class="font-bold text-white">${a.title}</h4>
                            <small class="text-text-muted text-xs">${a.news_date}</small>
                        </div>
                        <button class="bg-red-500/20 text-red-500 px-3 py-1 rounded text-sm hover:bg-red-500 hover:text-white transition" onclick="deleteNews('${a.id}')">Excluir</button>
                    </div>
                `}));const i=await s.getPartners(),n=document.getElementById("partners-list");n&&(n.innerHTML="",i.forEach(a=>{n.innerHTML+=`
                    <div class="bg-secondary-dark border border-glass-border p-4 rounded-lg flex justify-between items-center group hover:border-accent-cyan transition-colors">
                        <div>
                            <h4 class="font-bold text-white">${a.name}</h4>
                        </div>
                        <button class="bg-red-500/20 text-red-500 px-3 py-1 rounded text-sm hover:bg-red-500 hover:text-white transition" onclick="deletePartner('${a.id}')">Excluir</button>
                    </div>
                `}));const t=await s.getServices(),o=document.getElementById("services-list");o&&(o.innerHTML="",t.forEach(a=>{o.innerHTML+=`
                    <div class="bg-secondary-dark border border-glass-border p-4 rounded-lg flex gap-4 items-center group hover:border-accent-cyan transition-colors">
                        <img src="${a.image}" alt="${a.title}" class="w-16 h-16 object-cover rounded border border-glass-border">
                        <div class="flex-grow">
                            <h4 class="font-bold text-white">${a.title}</h4>
                            <p class="text-text-muted text-xs line-clamp-1">${a.description}</p>
                        </div>
                        <button class="bg-red-500/20 text-red-500 px-3 py-1 rounded text-sm hover:bg-red-500 hover:text-white transition" onclick="deleteService('${a.id}')">Excluir</button>
                    </div>
                `}));const l=await s.getDirectors(),c=document.getElementById("directors-list");c&&(c.innerHTML="",l.forEach(a=>{c.innerHTML+=`
                    <div class="bg-secondary-dark border border-glass-border p-4 rounded-lg flex gap-4 items-center group hover:border-accent-cyan transition-colors">
                        <img src="${a.image}" alt="${a.name}" class="w-12 h-12 rounded-full border-2 border-glass-border object-cover">
                        <div class="flex-grow">
                            <h4 class="font-bold text-white">${a.name}</h4>
                            <div class="flex gap-2 text-xs">
                                <span class="text-accent-cyan font-bold uppercase">${a.role}</span>
                                <span class="text-text-muted">| ${a.company}</span>
                            </div>
                        </div>
                        <button class="bg-red-500/20 text-red-500 px-3 py-1 rounded text-sm hover:bg-red-500 hover:text-white transition" onclick="deleteDirector('${a.id}')">Excluir</button>
                    </div>
                `}))}static async deleteNews(e){confirm("Tem certeza que deseja excluir esta notícia?")&&(await s.deleteNews(e),this.loadData())}static async deletePartner(e){confirm("Tem certeza que deseja excluir este parceiro?")&&(await s.deletePartner(e),this.loadData())}static async deleteService(e){confirm("Tem certeza que deseja excluir este serviço?")&&(await s.deleteService(e),this.loadData())}static async deleteDirector(e){confirm("Tem certeza que deseja excluir este diretor?")&&(await s.deleteDirector(e),this.loadData())}static async handleAddNews(e){e.preventDefault();const r=document.getElementById("news-file");let n=document.getElementById("news-img").value;if(r.files&&r.files[0])try{n=await this.readFileAsBase64(r.files[0])}catch(o){console.error("Error reading file",o),alert("Erro ao ler arquivo de imagem.");return}else n||(n="assets/news-placeholder.jpg");const t={title:document.getElementById("news-title").value,date:document.getElementById("news-date").value,img:n,link:document.getElementById("news-link").value};await s.addNews(t),alert("Notícia Publicada!"),this.loadData(),e.target.reset()}static async handleAddPartner(e){e.preventDefault(),console.log("Adding partner...");const r=document.getElementById("partner-file");let n=document.getElementById("partner-logo").value;if(r.files&&r.files[0]){console.log("Reading file:",r.files[0].name);try{n=await this.readFileAsBase64(r.files[0]),console.log("File read success, base64 length:",n.length)}catch(o){console.error("Error reading file",o),alert("Erro ao ler a imagem! Tente outro arquivo.");return}}if(!n&&!document.getElementById("partner-name").value){alert("Preencha pelo menos o nome!");return}const t={name:document.getElementById("partner-name").value,video:document.getElementById("partner-video").value,logo:n};try{await s.addPartner(t),console.log("Partner added to storage"),alert("Parceiro Adicionado com Sucesso!"),this.loadData(),e.target.reset()}catch(o){console.error(o),alert("Erro ao salvar: "+o.message)}}static async handleAddService(e){e.preventDefault();const r=document.getElementById("service-file");let n=document.getElementById("service-img").value;if(r.files&&r.files[0])try{n=await this.readFileAsBase64(r.files[0])}catch(o){console.error("Error reading file",o);return}const t={title:document.getElementById("service-title").value,description:document.getElementById("service-desc").value,image:n};await s.addService(t),alert("Serviço Adicionado!"),this.loadData(),e.target.reset()}static async handleAddDirector(e){e.preventDefault();const r=document.getElementById("director-file");let n=document.getElementById("director-img").value;if(r.files&&r.files[0])try{n=await this.readFileAsBase64(r.files[0])}catch(o){console.error("Error reading file",o);return}const t={name:document.getElementById("director-name").value,role:document.getElementById("director-role").value,company:document.getElementById("director-company").value,image:n};await s.addDirector(t),alert("Diretor Adicionado!"),this.loadData(),e.target.reset()}}u.init();
