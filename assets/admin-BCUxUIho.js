var b=Object.defineProperty;var x=(g,e,i)=>e in g?b(g,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):g[e]=i;var v=(g,e,i)=>x(g,typeof e!="symbol"?e+"":e,i);import{o as E,s as I,a as f,b as B,c as L,A as d}from"./api-C4wM4lTA.js";console.log("AdminUI Module: Loading imports...");class p{static readFileAsBase64(e){return new Promise((i,t)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=r=>{const a=new Image;a.src=r.target.result,a.onload=()=>{let c=a.width,l=a.height;c>l?c>1920&&(l*=1920/c,c=1920):l>1920&&(c*=1920/l,l=1920);const m=document.createElement("canvas");m.width=c,m.height=l,m.getContext("2d").drawImage(a,0,0,c,l),i(m.toDataURL("image/jpeg",.9))},a.onerror=o=>t(o)},s.onerror=r=>t(r)})}static setupLivePreviews(){const e=document.getElementById("director-img"),i=document.getElementById("director-file"),t=document.getElementById("director-preview-img");e&&t&&e.addEventListener("input",s=>{s.target.value?t.src=s.target.value:t.src="assets/avatar_placeholder.png"}),i&&t&&i.addEventListener("change",async s=>{if(s.target.files&&s.target.files[0])try{const r=await this.readFileAsBase64(s.target.files[0]);t.src=r,e&&(e.value="")}catch(r){console.error(r)}})}static init(){var e,i,t,s;console.log("AdminUI: Initializing..."),this.globalEditor=new Quill("#global-editor",{theme:"snow",placeholder:"Escreva seu conteúdo aqui...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","clean"]]}}),document.getElementById("news-inline-editor")&&(this.newsInlineEditor=new Quill("#news-inline-editor",{theme:"snow",placeholder:"Escreva o artigo completo...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image","video","clean"]]}})),window.checkAuth=()=>this.checkAuth(),window.logout=()=>this.logout(),window.AdminUI=this,this.setupLivePreviews(),E(f,r=>{r?this.showAdminPanel():this.showLogin()}),window.switchTab=r=>this.switchTab(r),window.deleteNews=r=>this.deleteNews(r),window.deletePartner=r=>this.deletePartner(r),window.deleteService=r=>this.deleteService(r),window.deleteDirector=r=>this.deleteDirector(r),window.editService=r=>this.editService(r),window.editDirector=r=>this.editDirector(r),window.moveDirector=(r,a)=>this.moveDirector(r,a),window.removeServiceGalleryItem=r=>this.removeServiceGalleryItem(r),window.removeNewsGalleryItem=r=>this.removeNewsGalleryItem(r),window.handleDeleteRequest=r=>this.handleDeleteRequest(r),(e=document.getElementById("news-form"))==null||e.addEventListener("submit",r=>this.handleAddNews(r)),(i=document.getElementById("partner-form"))==null||i.addEventListener("submit",r=>this.handleAddPartner(r)),(t=document.getElementById("service-form"))==null||t.addEventListener("submit",r=>this.handleAddService(r)),(s=document.getElementById("director-form"))==null||s.addEventListener("submit",r=>this.handleAddDirector(r)),this.editingNewsId=null,window.editNews=r=>this.editNews(r),window.createTestAdmin=()=>this.createTestAdmin(),window.updateDirectorOrder=(r,a)=>this.updateDirectorOrder(r,a)}static showNewsForm(){document.getElementById("view-news-list").classList.add("hidden"),document.getElementById("view-news-form").classList.remove("hidden");const e=this.editingNewsId?"Editar Notícia":"Nova Notícia";document.getElementById("news-form-title").innerText=e,this.editingNewsId||(document.getElementById("news-form").reset(),this.newsInlineEditor&&this.newsInlineEditor.setText(""),this.editingNewsGallery=[],this.renderNewsGalleryPreview())}static showNewsList(){document.getElementById("view-news-form").classList.add("hidden"),document.getElementById("view-news-list").classList.remove("hidden"),this.editingNewsId=null}static openEditor(e,i,t){this.currentEditorTarget=e,this.currentPreviewTarget=t;const s=document.getElementById(e).value;this.globalEditor.clipboard.dangerouslyPasteHTML(s||""),document.getElementById("editor-modal-title").innerText=i,document.getElementById("editor-modal").classList.remove("hidden")}static closeEditor(){document.getElementById("editor-modal").classList.add("hidden"),this.currentEditorTarget=null,this.currentPreviewTarget=null}static saveEditor(){if(!this.currentEditorTarget)return;const e=this.globalEditor.root.innerHTML;if(document.getElementById(this.currentEditorTarget).value=e,this.currentPreviewTarget){const i=document.createElement("div");i.innerHTML=e;const t=i.textContent||i.innerText||"";document.getElementById(this.currentPreviewTarget).innerText=t.substring(0,150)+(t.length>150?"...":""),document.getElementById(this.currentPreviewTarget).classList.remove("opacity-70","italic")}this.closeEditor()}static async checkAuth(){console.log("AdminUI: checkAuth called");const e=document.getElementById("admin-email").value,i=document.getElementById("admin-pass").value;try{await I(f,e,i)}catch(t){console.error("Login Error:",t),alert("E-mail ou senha incorretos! (Erro: "+t.code+")")}}static async logout(){try{await B(f),window.location.reload()}catch(e){console.error("Logout Error:",e)}}static async createTestAdmin(){try{await L(f,"admin@sindinor.com","123456"),alert("Usuário admin@sindinor.com criado com sucesso! Senha: 123456"),this.checkAuth()}catch(e){console.error("Create Admin Error:",e),e.code==="auth/email-already-in-use"?alert("O usuário admin@sindinor.com já existe. Tente fazer login com a senha 123456."):alert("Erro ao criar admin: "+e.message)}}static showLogin(){document.getElementById("auth-overlay").style.display="flex",document.getElementById("admin-content").style.display="none"}static showAdminPanel(){document.getElementById("auth-overlay").style.display="none",document.getElementById("admin-content").style.display="flex",this.loadData(),this.switchTab("news")}static switchTab(e){document.querySelectorAll(".tab-content").forEach(t=>{t.classList.add("hidden"),t.classList.remove("active")}),document.querySelectorAll(".nav-btn").forEach(t=>t.classList.remove("active")),document.getElementById(`tab-${e}`).classList.remove("hidden"),document.getElementById(`tab-${e}`).classList.add("active");const i=document.querySelector(`button[onclick="switchTab('${e}')"]`);i&&i.classList.add("active")}static async loadData(){const[e,i,t,s,r,a]=await Promise.all([d.getNews(),d.getPartners(),d.getServices(),d.getDirectors(),d.getRequests(),d.getGeneral()]);if(a&&a.notificationEmail){const n=document.getElementById("setting-notification-email");n&&(n.value=a.notificationEmail)}const o=document.getElementById("news-grid");o&&(o.innerHTML="",e.length===0?o.innerHTML=`
                <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                    <i class="fas fa-newspaper text-6xl mb-4 opacity-50"></i>
                    <p class="uppercase tracking-widest font-bold">Nenhuma notícia publicada</p>
                </div>
            `:e.forEach(n=>{const h=new Date(n.news_date).toLocaleDateString(),w=document.createElement("div");w.innerHTML=n.content;const y=(w.textContent||w.innerText||"").substring(0,150)+"...";o.innerHTML+=`
                    <div class="bg-secondary-dark border border-glass-border rounded-xl overflow-hidden shadow-lg hover:shadow-cyan-500/10 transition-all duration-300 hover:border-accent-cyan group flex flex-col h-full animate-fade-in">
                        <div class="h-48 overflow-hidden relative">
                             <img src="${n.img}" alt="${n.title}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                             <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                             <div class="absolute bottom-3 left-3">
                                 <span class="text-accent-cyan text-[10px] font-bold uppercase tracking-widest bg-black/60 px-2 py-1 rounded backdrop-blur-sm border border-glass-border">
                                    <i class="far fa-calendar-alt mr-1"></i> ${h}
                                 </span>
                             </div>
                        </div>
                        <div class="p-6 flex flex-col flex-grow">
                            <h4 class="font-heading font-bold text-white text-lg mb-3 line-clamp-2 leading-tight group-hover:text-accent-cyan transition-colors">${n.title}</h4>
                            <p class="text-text-muted text-sm line-clamp-3 mb-6 flex-grow font-light border-l-2 border-glass-border pl-3">
                               ${y}
                            </p>
                            <div class="flex justify-between items-center pt-4 border-t border-glass-border mt-auto">
                                <button onclick="window.editNews('${n.id}')" 
                                    class="text-accent-cyan hover:text-white text-xs font-bold uppercase tracking-widest flex items-center gap-2 px-3 py-2 rounded hover:bg-white/5 transition-colors">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button onclick="window.deleteNews('${n.id}')" 
                                    class="text-red-500 hover:text-red-400 text-xs font-bold uppercase tracking-widest flex items-center gap-2 px-3 py-2 rounded hover:bg-white/5 transition-colors">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    </div>
                `}));const u=document.getElementById("partners-grid");u&&(u.innerHTML="",i.length===0?u.innerHTML=`
                    <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                        <i class="fas fa-handshake text-6xl mb-4 opacity-50"></i>
                        <p class="uppercase tracking-widest font-bold">Nenhum parceiro cadastrado</p>
                    </div>`:i.forEach(n=>{u.innerHTML+=`
                        <div class="bg-secondary-dark border border-glass-border rounded-xl p-6 flex flex-col items-center text-center group hover:border-accent-cyan transition-colors shadow-lg hover:shadow-cyan-500/10">
                            <div class="w-24 h-24 mb-4 bg-white/5 rounded-full p-4 border border-glass-border flex items-center justify-center">
                                <img src="${n.logo||"assets/logo_placeholder.png"}" alt="${n.name}" class="max-w-full max-h-full object-contain">
                            </div>
                            <h4 class="font-heading font-bold text-xl text-white mb-2 group-hover:text-accent-cyan transition-colors">${n.name}</h4>
                            <p class="text-text-muted text-sm line-clamp-2 mb-4 font-light">${n.description||"Sem descrição"}</p>
                            
                            <div class="flex gap-2 w-full mt-auto pt-4 border-t border-glass-border justify-center">
                                <button class="text-red-500 hover:text-red-400 text-xs font-bold uppercase tracking-widest flex items-center gap-2 px-3 py-2 rounded hover:bg-white/5 transition-colors" onclick="window.deletePartner('${n.id}')">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    `}));const c=document.getElementById("services-list");c&&(c.innerHTML="",t.length===0?c.innerHTML=`
                    <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                        <i class="fas fa-concierge-bell text-6xl mb-4 opacity-50"></i>
                        <p class="uppercase tracking-widest font-bold">Nenhum serviço cadastrado</p>
                    </div>`:t.forEach(n=>{c.innerHTML+=`
                        <div class="bg-secondary-dark border border-glass-border rounded-xl p-6 flex flex-col group hover:border-accent-cyan transition-colors shadow-lg hover:shadow-cyan-500/10 h-full">
                            <div class="w-16 h-16 mb-6 bg-white/5 rounded-lg p-3 border border-glass-border flex items-center justify-center self-start">
                                <img src="${n.image||"assets/logo_placeholder.png"}" alt="${n.title}" class="w-full h-full object-contain">
                            </div>
                            <h4 class="font-heading font-bold text-xl text-white mb-3 group-hover:text-accent-cyan transition-colors">${n.title}</h4>
                            <p class="text-text-muted text-sm line-clamp-3 mb-6 font-light border-l-2 border-glass-border pl-4">${n.description}</p>
                            
                            <div class="flex gap-3 mt-auto pt-6 border-t border-glass-border">
                                 <button class="flex-1 text-accent-cyan hover:text-white text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-3 rounded bg-accent-cyan/10 hover:bg-accent-cyan/20 transition-colors" onclick="window.editService('${n.id}')">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="flex-1 text-red-500 hover:text-red-400 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-3 rounded bg-red-500/10 hover:bg-red-500/20 transition-colors" onclick="window.deleteService('${n.id}')">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    `}));const l=document.getElementById("directors-list");l&&(l.innerHTML="",s.length===0?l.innerHTML=`
                    <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                        <i class="fas fa-users text-6xl mb-4 opacity-50"></i>
                        <p class="uppercase tracking-widest font-bold">Nenhum diretor cadastrado</p>
                    </div>`:s.forEach(n=>{l.innerHTML+=`
                        <div class="bg-secondary-dark border border-glass-border rounded-xl p-6 flex flex-col items-center text-center group hover:border-accent-cyan transition-colors shadow-lg hover:shadow-cyan-500/10 relative">
                            <div class="w-32 h-32 mb-4 relative">
                                <div class="absolute inset-0 bg-accent-cyan/20 blur-xl rounded-full scale-0 group-hover:scale-100 transition-transform duration-500"></div>
                                <img src="${n.image||"assets/avatar_placeholder.png"}" alt="${n.name}" class="w-full h-full rounded-full border-4 border-glass-border object-cover relative z-10 group-hover:border-accent-cyan transition-colors">
                            </div>
                            
                            <h4 class="font-heading font-bold text-xl text-white mb-1 group-hover:text-accent-cyan transition-colors">${n.name}</h4>
                            <p class="text-accent-cyan text-xs font-black uppercase tracking-widest mb-1">${n.role}</p>
                            <p class="text-text-muted text-xs font-medium mb-6">${n.company||""}</p>
                            
                            <div class="w-full mt-auto pt-4 border-t border-glass-border flex flex-col gap-2">
                                <div class="flex items-center gap-2 mb-2 bg-glass-bg p-2 rounded">
                                    <label class="text-accent-cyan text-xs font-bold uppercase tracking-widest whitespace-nowrap">Ordem:</label>
                                    <input type="number" value="${n.order!==void 0?n.order:99}" 
                                        class="w-full bg-primary-dark border border-glass-border rounded px-2 py-1 text-white text-center font-bold focus:border-accent-cyan outline-none"
                                        onchange="window.updateDirectorOrder('${n.id}', this.value)">
                                </div>
                                <div class="grid grid-cols-2 gap-2">
                                    <button class="text-accent-cyan hover:text-white hover:bg-accent-cyan/10 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-2 rounded transition-all" onclick="window.editDirector('${n.id}')">
                                        <i class="fas fa-edit"></i> Editar
                                    </button>
                                    <button class="text-red-500 hover:text-white hover:bg-red-500/80 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-2 rounded transition-all" onclick="window.deleteDirector('${n.id}')">
                                        <i class="fas fa-trash"></i> Remover
                                    </button>
                                </div>
                            </div>
                        </div>
                    `}));const m=document.getElementById("requests-list");m&&(r.length===0?m.innerHTML=`
                        <div class="bg-secondary-dark/50 border border-dashed border-glass-border p-12 rounded-xl text-center col-span-full">
                            <i class="fas fa-inbox text-4xl text-text-muted mb-4"></i>
                            <p class="text-text-muted">Nenhuma solicitação encontrada.</p>
                        </div>
                    `:m.innerHTML=r.map(n=>`
                        <div class="bg-secondary-dark border border-glass-border p-6 rounded-xl relative hover:border-accent-cyan transition-colors group">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="font-heading font-bold text-xl text-white underline underline-offset-4 decoration-accent-cyan/30">${n.company}</h3>
                                    <p class="text-accent-cyan text-[10px] font-black uppercase tracking-widest mt-2 bg-accent-cyan/10 inline-block px-2 py-0.5 rounded">${n.cnpj}</p>
                                </div>
                                <button onclick="handleDeleteRequest('${n.id}')" class="text-text-muted hover:text-red-500 transition-colors p-2 bg-glass-bg rounded-lg">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-6">
                                <div class="bg-primary-dark/50 p-3 rounded-lg border border-glass-border">
                                    <span class="block text-accent-cyan text-[9px] uppercase font-black tracking-tighter mb-1 opacity-70">Responsável</span>
                                    <p class="text-white font-bold">${n.name}</p>
                                    <p class="text-text-muted text-xs font-medium">${n.role}</p>
                                </div>
                                <div class="bg-primary-dark/50 p-3 rounded-lg border border-glass-border">
                                    <span class="block text-accent-cyan text-[9px] uppercase font-black tracking-tighter mb-1 opacity-70">Contato</span>
                                    <p class="text-white font-bold">${n.phone}</p>
                                    <a href="https://wa.me/55${n.phone.replace(/\D/g,"")}" target="_blank" 
                                        class="flex items-center gap-2 mt-2 text-green-400 hover:text-green-300 text-xs font-bold uppercase">
                                        <i class="fab fa-whatsapp"></i> Chamar
                                    </a>
                                </div>
                            </div>
                            <div class="bg-primary-dark/50 p-4 rounded-lg border border-glass-border mt-auto">
                                <span class="block text-accent-cyan text-[9px] uppercase font-black tracking-tighter mb-2 opacity-70">Mensagem</span>
                                <p class="text-text-muted text-sm italic leading-relaxed">"${n.message}"</p>
                            </div>
                        </div>
                    `).join(""))}static showPartnerForm(){document.getElementById("view-partners-list").classList.add("hidden"),document.getElementById("view-partners-form").classList.remove("hidden"),document.getElementById("partner-form-title").innerText="Novo Parceiro",document.getElementById("partner-form").reset()}static showPartnerList(){document.getElementById("view-partners-form").classList.add("hidden"),document.getElementById("view-partners-list").classList.remove("hidden")}static showServiceForm(e=!0){document.getElementById("view-services-list").classList.add("hidden"),document.getElementById("view-services-form").classList.remove("hidden"),e&&(document.getElementById("service-form-title").innerHTML='<span class="w-1 h-8 bg-accent-cyan rounded-full"></span> Novo Serviço',document.getElementById("service-form").reset(),document.getElementById("service-content-raw").value="",document.getElementById("service-content-preview").innerText="(O conteúdo aparecerá aqui após a edição...)",this.editingServiceId=null,this.editingGallery=[])}static showServiceList(){document.getElementById("view-services-form").classList.add("hidden"),document.getElementById("view-services-list").classList.remove("hidden")}static showDirectorForm(e=!0){document.getElementById("view-directors-list").classList.add("hidden"),document.getElementById("view-directors-form").classList.remove("hidden"),e&&(document.getElementById("director-form-title").innerText="Novo Diretor",document.getElementById("director-form").reset(),document.getElementById("director-preview-img").src="assets/avatar_placeholder.png",document.getElementById("director-img").value="")}static showDirectorList(){document.getElementById("view-directors-form").classList.add("hidden"),document.getElementById("view-directors-list").classList.remove("hidden")}static async deleteNews(e){confirm("Tem certeza que deseja excluir esta notícia?")&&(await d.deleteNews(e),this.loadData())}static async deletePartner(e){confirm("Tem certeza que deseja excluir este parceiro?")&&(await d.deletePartner(e),this.loadData())}static async deleteService(e){confirm("Tem certeza que deseja excluir este serviço?")&&(await d.deleteService(e),this.loadData())}static async deleteDirector(e){confirm("Tem certeza que deseja excluir este diretor?")&&(await d.deleteDirector(e),this.loadData())}static async handleAddNews(e){e.preventDefault();const i=e.target.querySelector('button[type="submit"]'),t=i.innerHTML;i.innerHTML='<i class="fas fa-spinner fa-spin"></i> Salvando...',i.disabled=!0;try{const s=document.getElementById("news-file");let a=document.getElementById("news-img").value;if(s.files&&s.files[0])try{a=await this.readFileAsBase64(s.files[0])}catch(n){console.error("Error reading file",n),alert("Erro ao ler arquivo de imagem.");return}else!a&&!this.editingNewsId&&(a="assets/news-placeholder.jpg");let o=[...this.editingNewsGallery];const u=document.getElementById("news-gallery-urls");if(u&&u.value){const n=u.value.split(",").map(h=>h.trim()).filter(h=>h);o=[...o,...n]}const c=document.getElementById("news-gallery-files");if(c&&c.files&&c.files.length>0)for(let n=0;n<c.files.length;n++)try{const h=await this.readFileAsBase64(c.files[n]);o.push(h)}catch(h){console.error("Error reading gallery file",h)}const l=this.newsInlineEditor?this.newsInlineEditor.root.innerHTML:"",m={title:document.getElementById("news-title").value,news_date:document.getElementById("news-date").value,img:a,content:l,gallery:o};this.editingNewsId?(await d.updateNews(this.editingNewsId,m),alert("Notícia Atualizada!")):(await d.addNews(m),alert("Notícia Publicada!")),this.loadData(),this.showNewsList()}catch(s){console.error(s),alert("Erro ao salvar notícia: "+s.message)}finally{i.innerHTML=t,i.disabled=!1}}static async editNews(e){const t=(await d.getNews()).find(s=>s.id===e);if(!t){alert("Erro: Notícia não encontrada.");return}this.editingNewsId=e,document.getElementById("news-title").value=t.title,document.getElementById("news-date").value=t.news_date,document.getElementById("news-img").value=t.img||"",this.newsInlineEditor&&this.newsInlineEditor.clipboard.dangerouslyPasteHTML(t.content||""),this.editingNewsGallery=t.gallery||[],this.renderNewsGalleryPreview(),this.showNewsForm()}static renderNewsGalleryPreview(){const e=document.getElementById("news-gallery-preview");e&&(e.innerHTML=this.editingNewsGallery.map((i,t)=>`
            <div class="relative w-16 h-16 rounded border border-glass-border overflow-hidden bg-white/5 group">
                <img src="${i}" class="w-full h-full object-cover">
                <button type="button" onclick="window.removeNewsGalleryItem(${t})" class="absolute inset-0 bg-red-500/80 text-white opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `).join(""),this.editingNewsGallery.length===0&&(e.innerHTML='<p class="text-text-muted text-[10px] uppercase tracking-widest italic">Nenhuma foto na galeria</p>'))}static removeNewsGalleryItem(e){this.editingNewsGallery.splice(e,1),this.renderNewsGalleryPreview()}static async handleAddPartner(e){e.preventDefault();const i=e.target.querySelector('button[type="submit"]'),t=i.innerHTML;i.innerHTML='<i class="fas fa-spinner fa-spin"></i> Salvando...',i.disabled=!0;try{const s=document.getElementById("partner-logo-file");let a=document.getElementById("partner-logo-url").value;if(s.files&&s.files[0])try{a=await this.readFileAsBase64(s.files[0])}catch(u){console.error("Error reading file",u),alert("Erro ao ler arquivo de imagem.");return}const o={name:document.getElementById("partner-name").value,logo:a,description:document.getElementById("partner-desc").value,video_url:document.getElementById("partner-video").value};await d.addPartner(o),alert("Parceiro Adicionado!"),this.loadData(),this.showPartnerList(),e.target.reset()}catch(s){console.error(s),alert("Erro ao salvar parceiro: "+s.message)}finally{i.innerHTML=t,i.disabled=!1}}static async handleAddService(e){e.preventDefault();const i=document.getElementById("editing-service-id").value,t=document.getElementById("service-file");let r=document.getElementById("service-img").value;if(t.files&&t.files[0])try{r=await this.readFileAsBase64(t.files[0])}catch(l){console.error("Error reading file",l);return}let a=[...this.editingGallery];const o=document.getElementById("service-gallery-urls");if(o.value){const l=o.value.split(",").map(m=>m.trim()).filter(m=>m);a=[...a,...l]}const u=document.getElementById("service-gallery-files");if(u.files&&u.files.length>0)for(let l=0;l<u.files.length;l++)try{const m=await this.readFileAsBase64(u.files[l]);a.push(m)}catch(m){console.error("Error reading gallery file",m)}const c={title:document.getElementById("service-title").value,description:document.getElementById("service-desc").value,full_description:document.getElementById("service-content-raw").value,image:r,gallery:a};i?(await d.updateService(i,c),alert("Serviço Atualizado!")):(await d.addService(c),alert("Serviço Adicionado!")),this.loadData(),e.target.reset(),document.getElementById("service-content-raw").value="",document.getElementById("service-content-preview").innerText="(O conteúdo aparecerá aqui após a edição...)",document.getElementById("service-content-preview").classList.add("opacity-70","italic"),this.editingGallery=[],this.renderGalleryPreview(),document.getElementById("editing-service-id").value="",this.showServiceList()}static async editService(e){const t=(await d.getServices()).find(o=>o.id===e);if(!t)return;document.getElementById("editing-service-id").value=t.id,document.getElementById("service-title").value=t.title,document.getElementById("service-desc").value=t.description;const s=t.full_description||"";document.getElementById("service-content-raw").value=s;const r=document.createElement("div");r.innerHTML=s;const a=r.textContent||r.innerText||"";document.getElementById("service-content-preview").innerText=a.substring(0,150)+(a.length>150?"...":""),document.getElementById("service-content-preview").classList.remove("opacity-70","italic"),document.getElementById("service-img").value=t.image.startsWith("data:")?"":t.image,document.getElementById("service-gallery-urls").value="",this.editingGallery=t.gallery?[...t.gallery]:[],this.renderGalleryPreview(),document.getElementById("service-form-title").innerHTML='<span class="w-1 h-6 bg-accent-cyan rounded-full"></span> Editar Serviço',this.showServiceForm(!1)}static renderGalleryPreview(){const e=document.getElementById("service-gallery-preview");e&&(e.innerHTML=this.editingGallery.map((i,t)=>`
            <div class="relative w-16 h-16 rounded border border-glass-border overflow-hidden bg-white/5 group">
                <img src="${i}" class="w-full h-full object-cover">
                <button type="button" onclick="window.removeServiceGalleryItem(${t})" class="absolute inset-0 bg-red-500/80 text-white opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `).join(""),this.editingGallery.length===0&&(e.innerHTML='<p class="text-text-muted text-[10px] uppercase tracking-widest italic">Nenhuma foto na galeria</p>'))}static removeServiceGalleryItem(e){this.editingGallery.splice(e,1),this.renderGalleryPreview()}static async handleAddDirector(e){e.preventDefault();const i=document.getElementById("director-file"),t=document.getElementById("director-img");let s=t?t.value:"";if(i.files&&i.files[0])try{s=await this.readFileAsBase64(i.files[0])}catch(o){console.error("Error reading file",o);return}const r=document.getElementById("editing-director-id").value,a={name:document.getElementById("director-name").value,role:document.getElementById("director-role").value,company:document.getElementById("director-company").value,image:s};try{if(r)await d.updateDirector(r,a),alert("Diretor Atualizado!");else{const u=(await d.getDirectors()).reduce((c,l)=>Math.max(c,l.order||0),0);a.order=u+1,await d.addDirector(a),alert("Diretor Adicionado!")}this.loadData(),e.target.reset(),document.getElementById("director-img").value="",document.getElementById("editing-director-id").value="",this.showDirectorList()}catch(o){console.error(o),alert("Erro: "+o.message)}}static async editDirector(e){const t=(await d.getDirectors()).find(r=>r.id===e);if(!t)return;document.getElementById("editing-director-id").value=t.id,document.getElementById("director-name").value=t.name,document.getElementById("director-role").value=t.role,document.getElementById("director-company").value=t.company||"",document.getElementById("director-img").value=t.image||"",document.getElementById("director-img").value=t.image||"";const s=document.getElementById("director-preview-img");s&&(s.src=t.image||"assets/avatar_placeholder.png"),this.showDirectorForm(!1),document.getElementById("director-form-title").innerText="Editar Membro"}static async updateDirectorOrder(e,i){const t=parseInt(i);isNaN(t)||(await d.updateDirector(e,{order:t}),this.loadData())}static async handleDeleteRequest(e){confirm("Deseja excluir esta solicitação?")&&(await d.deleteRequest(e),this.loadData())}static async saveSettings(e){e.preventDefault();const i=document.getElementById("setting-notification-email").value,t=e.target.querySelector('button[type="submit"]'),s=t.innerHTML;t.innerHTML='<i class="fas fa-spinner fa-spin"></i> Salvando...',t.disabled=!0;try{await d.updateGeneral({notificationEmail:i}),alert("Configurações salvas com sucesso!")}catch(r){console.error("Error saving settings:",r),alert("Erro ao salvar configurações.")}finally{t.innerHTML=s,t.disabled=!1}}}v(p,"currentEditorTarget",null),v(p,"currentPreviewTarget",null),v(p,"editingNewsGallery",[]),v(p,"editingGallery",[]);document.addEventListener("DOMContentLoaded",()=>{try{console.log("AdminUI: Booting initialization..."),console.log("AdminUI: Booting initialization..."),p.init(),console.log("AdminUI: Initialization complete.")}catch(g){console.error("AdminUI: Fatal Init Error:",g),alert("Erro fatal ao iniciar AdminUI: "+g.message)}});
