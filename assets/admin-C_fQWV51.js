var y=Object.defineProperty;var b=(h,e,i)=>e in h?y(h,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[e]=i;var v=(h,e,i)=>b(h,typeof e!="symbol"?e+"":e,i);import{o as x,s as E,a as f,b as I,A as c}from"./api-BYJfvy6u.js";console.log("AdminUI Module: Loading imports...");class p{static readFileAsBase64(e){return new Promise((i,t)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=r=>{const a=new Image;a.src=r.target.result,a.onload=()=>{let l=a.width,d=a.height;l>d?l>1920&&(d*=1920/l,l=1920):d>1920&&(l*=1920/d,d=1920);const n=document.createElement("canvas");n.width=l,n.height=d,n.getContext("2d").drawImage(a,0,0,l,d),i(n.toDataURL("image/jpeg",.9))},a.onerror=o=>t(o)},s.onerror=r=>t(r)})}static setupLivePreviews(){const e=document.getElementById("director-img"),i=document.getElementById("director-file"),t=document.getElementById("director-preview-img");e&&t&&e.addEventListener("input",s=>{s.target.value?t.src=s.target.value:t.src="assets/avatar_placeholder.png"}),i&&t&&i.addEventListener("change",async s=>{if(s.target.files&&s.target.files[0])try{const r=await this.readFileAsBase64(s.target.files[0]);t.src=r,e&&(e.value="")}catch(r){console.error(r)}})}static init(){var e,i,t,s;console.log("AdminUI: Initializing..."),this.globalEditor=new Quill("#global-editor",{theme:"snow",placeholder:"Escreva seu conteúdo aqui...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","clean"]]}}),document.getElementById("news-inline-editor")&&(this.newsInlineEditor=new Quill("#news-inline-editor",{theme:"snow",placeholder:"Escreva o artigo completo...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image","video","clean"]]}})),window.checkAuth=()=>this.checkAuth(),window.logout=()=>this.logout(),window.AdminUI=this,this.setupLivePreviews(),x(f,r=>{r?this.showAdminPanel():this.showLogin()}),window.switchTab=r=>this.switchTab(r),window.deleteNews=r=>this.deleteNews(r),window.deletePartner=r=>this.deletePartner(r),window.deleteService=r=>this.deleteService(r),window.deleteDirector=r=>this.deleteDirector(r),window.editService=r=>this.editService(r),window.editDirector=r=>this.editDirector(r),window.removeServiceGalleryItem=r=>this.removeServiceGalleryItem(r),window.removeNewsGalleryItem=r=>this.removeNewsGalleryItem(r),window.handleDeleteRequest=r=>this.handleDeleteRequest(r),(e=document.getElementById("news-form"))==null||e.addEventListener("submit",r=>this.handleAddNews(r)),(i=document.getElementById("partner-form"))==null||i.addEventListener("submit",r=>this.handleAddPartner(r)),(t=document.getElementById("service-form"))==null||t.addEventListener("submit",r=>this.handleAddService(r)),(s=document.getElementById("director-form"))==null||s.addEventListener("submit",r=>this.handleAddDirector(r)),this.editingNewsId=null,window.editNews=r=>this.editNews(r)}static showNewsForm(){document.getElementById("view-news-list").classList.add("hidden"),document.getElementById("view-news-form").classList.remove("hidden");const e=this.editingNewsId?"Editar Notícia":"Nova Notícia";document.getElementById("news-form-title").innerText=e,this.editingNewsId||(document.getElementById("news-form").reset(),this.newsInlineEditor&&this.newsInlineEditor.setText(""),this.editingNewsGallery=[],this.renderNewsGalleryPreview())}static showNewsList(){document.getElementById("view-news-form").classList.add("hidden"),document.getElementById("view-news-list").classList.remove("hidden"),this.editingNewsId=null}static openEditor(e,i,t){this.currentEditorTarget=e,this.currentPreviewTarget=t;const s=document.getElementById(e).value;this.globalEditor.clipboard.dangerouslyPasteHTML(s||""),document.getElementById("editor-modal-title").innerText=i,document.getElementById("editor-modal").classList.remove("hidden")}static closeEditor(){document.getElementById("editor-modal").classList.add("hidden"),this.currentEditorTarget=null,this.currentPreviewTarget=null}static saveEditor(){if(!this.currentEditorTarget)return;const e=this.globalEditor.root.innerHTML;if(document.getElementById(this.currentEditorTarget).value=e,this.currentPreviewTarget){const i=document.createElement("div");i.innerHTML=e;const t=i.textContent||i.innerText||"";document.getElementById(this.currentPreviewTarget).innerText=t.substring(0,150)+(t.length>150?"...":""),document.getElementById(this.currentPreviewTarget).classList.remove("opacity-70","italic")}this.closeEditor()}static async checkAuth(){console.log("AdminUI: checkAuth called");const e=document.getElementById("admin-email").value,i=document.getElementById("admin-pass").value;try{await E(f,e,i)}catch(t){console.error("Login Error:",t),alert("E-mail ou senha incorretos! (Erro: "+t.code+")")}}static async logout(){try{await I(f),window.location.reload()}catch(e){console.error("Logout Error:",e)}}static showLogin(){document.getElementById("auth-overlay").style.display="flex",document.getElementById("admin-content").style.display="none"}static showAdminPanel(){document.getElementById("auth-overlay").style.display="none",document.getElementById("admin-content").style.display="flex",this.loadData(),this.switchTab("news")}static switchTab(e){document.querySelectorAll(".tab-content").forEach(t=>{t.classList.add("hidden"),t.classList.remove("active")}),document.querySelectorAll(".nav-btn").forEach(t=>t.classList.remove("active")),document.getElementById(`tab-${e}`).classList.remove("hidden"),document.getElementById(`tab-${e}`).classList.add("active");const i=document.querySelector(`button[onclick="switchTab('${e}')"]`);i&&i.classList.add("active")}static async loadData(){const[e,i,t,s,r]=await Promise.all([c.getNews(),c.getPartners(),c.getServices(),c.getDirectors(),c.getRequests()]),a=document.getElementById("news-grid");a&&(a.innerHTML="",e.length===0?a.innerHTML=`
                <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                    <i class="fas fa-newspaper text-6xl mb-4 opacity-50"></i>
                    <p class="uppercase tracking-widest font-bold">Nenhuma notícia publicada</p>
                </div>
            `:e.forEach(n=>{const g=new Date(n.news_date).toLocaleDateString(),u=document.createElement("div");u.innerHTML=n.content;const w=(u.textContent||u.innerText||"").substring(0,150)+"...";a.innerHTML+=`
                    <div class="bg-secondary-dark border border-glass-border rounded-xl overflow-hidden shadow-lg hover:shadow-cyan-500/10 transition-all duration-300 hover:border-accent-cyan group flex flex-col h-full animate-fade-in">
                        <div class="h-48 overflow-hidden relative">
                             <img src="${n.img}" alt="${n.title}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                             <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                             <div class="absolute bottom-3 left-3">
                                 <span class="text-accent-cyan text-[10px] font-bold uppercase tracking-widest bg-black/60 px-2 py-1 rounded backdrop-blur-sm border border-glass-border">
                                    <i class="far fa-calendar-alt mr-1"></i> ${g}
                                 </span>
                             </div>
                        </div>
                        <div class="p-6 flex flex-col flex-grow">
                            <h4 class="font-heading font-bold text-white text-lg mb-3 line-clamp-2 leading-tight group-hover:text-accent-cyan transition-colors">${n.title}</h4>
                            <p class="text-text-muted text-sm line-clamp-3 mb-6 flex-grow font-light border-l-2 border-glass-border pl-3">
                               ${w}
                            </p>
                            <div class="flex justify-between items-center pt-4 border-t border-glass-border mt-auto">
                                <button onclick="window.editNews('${n.id}')" 
                                    class="text-accent-cyan hover:text-white text-xs font-bold uppercase tracking-widest flex items-center gap-2 px-3 py-2 rounded hover:bg-white/5 transition-colors">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button onclick="window.deleteNews('${n.id}')" 
                                    class="text-red-500 hover:text-red-400 text-xs font-bold uppercase tracking-widest flex items-center gap-2 px-3 py-2 rounded hover:bg-white/5 transition-colors">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    </div>
                `}));const o=document.getElementById("partners-grid");o&&(o.innerHTML="",i.length===0?o.innerHTML=`
                    <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                        <i class="fas fa-handshake text-6xl mb-4 opacity-50"></i>
                        <p class="uppercase tracking-widest font-bold">Nenhum parceiro cadastrado</p>
                    </div>`:i.forEach(n=>{o.innerHTML+=`
                        <div class="bg-secondary-dark border border-glass-border rounded-xl p-6 flex flex-col items-center text-center group hover:border-accent-cyan transition-colors shadow-lg hover:shadow-cyan-500/10">
                            <div class="w-24 h-24 mb-4 bg-white/5 rounded-full p-4 border border-glass-border flex items-center justify-center">
                                <img src="${n.logo||"assets/logo_placeholder.png"}" alt="${n.name}" class="max-w-full max-h-full object-contain">
                            </div>
                            <h4 class="font-heading font-bold text-xl text-white mb-2 group-hover:text-accent-cyan transition-colors">${n.name}</h4>
                            <p class="text-text-muted text-sm line-clamp-2 mb-4 font-light">${n.description||"Sem descrição"}</p>
                            
                            <div class="flex gap-2 w-full mt-auto pt-4 border-t border-glass-border justify-center">
                                <button class="text-red-500 hover:text-red-400 text-xs font-bold uppercase tracking-widest flex items-center gap-2 px-3 py-2 rounded hover:bg-white/5 transition-colors" onclick="window.deletePartner('${n.id}')">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    `}));const m=document.getElementById("services-list");m&&(m.innerHTML="",t.length===0?m.innerHTML=`
                    <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                        <i class="fas fa-concierge-bell text-6xl mb-4 opacity-50"></i>
                        <p class="uppercase tracking-widest font-bold">Nenhum serviço cadastrado</p>
                    </div>`:t.forEach(n=>{m.innerHTML+=`
                        <div class="bg-secondary-dark border border-glass-border rounded-xl p-6 flex flex-col group hover:border-accent-cyan transition-colors shadow-lg hover:shadow-cyan-500/10 h-full">
                            <div class="w-16 h-16 mb-6 bg-white/5 rounded-lg p-3 border border-glass-border flex items-center justify-center self-start">
                                <img src="${n.image||"assets/logo_placeholder.png"}" alt="${n.title}" class="w-full h-full object-contain">
                            </div>
                            <h4 class="font-heading font-bold text-xl text-white mb-3 group-hover:text-accent-cyan transition-colors">${n.title}</h4>
                            <p class="text-text-muted text-sm line-clamp-3 mb-6 font-light border-l-2 border-glass-border pl-4">${n.description}</p>
                            
                            <div class="flex gap-3 mt-auto pt-6 border-t border-glass-border">
                                 <button class="flex-1 text-accent-cyan hover:text-white text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-3 rounded bg-accent-cyan/10 hover:bg-accent-cyan/20 transition-colors" onclick="window.editService('${n.id}')">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="flex-1 text-red-500 hover:text-red-400 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-3 rounded bg-red-500/10 hover:bg-red-500/20 transition-colors" onclick="window.deleteService('${n.id}')">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </div>
                        </div>
                    `}));const l=document.getElementById("directors-list");l&&(l.innerHTML="",s.length===0?l.innerHTML=`
                    <div class="col-span-full flex flex-col items-center justify-center text-text-muted py-20 border-2 border-dashed border-glass-border rounded-xl">
                        <i class="fas fa-users text-6xl mb-4 opacity-50"></i>
                        <p class="uppercase tracking-widest font-bold">Nenhum diretor cadastrado</p>
                    </div>`:s.forEach(n=>{l.innerHTML+=`
                        <div class="bg-secondary-dark border border-glass-border rounded-xl p-6 flex flex-col items-center text-center group hover:border-accent-cyan transition-colors shadow-lg hover:shadow-cyan-500/10 relative">
                            <div class="w-32 h-32 mb-4 relative">
                                <div class="absolute inset-0 bg-accent-cyan/20 blur-xl rounded-full scale-0 group-hover:scale-100 transition-transform duration-500"></div>
                                <img src="${n.image||"assets/avatar_placeholder.png"}" alt="${n.name}" class="w-full h-full rounded-full border-4 border-glass-border object-cover relative z-10 group-hover:border-accent-cyan transition-colors">
                            </div>
                            
                            <h4 class="font-heading font-bold text-xl text-white mb-1 group-hover:text-accent-cyan transition-colors">${n.name}</h4>
                            <p class="text-accent-cyan text-xs font-black uppercase tracking-widest mb-1">${n.role}</p>
                            <p class="text-text-muted text-xs font-medium mb-6">${n.company||""}</p>
                            
                            <div class="w-full mt-auto pt-4 border-t border-glass-border grid grid-cols-2 gap-2">
                                <button class="text-accent-cyan hover:text-white hover:bg-accent-cyan/10 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-2 rounded transition-all" onclick="window.editDirector('${n.id}')">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="text-red-500 hover:text-white hover:bg-red-500/80 text-xs font-bold uppercase tracking-widest flex items-center justify-center gap-2 px-4 py-2 rounded transition-all" onclick="window.deleteDirector('${n.id}')">
                                    <i class="fas fa-trash"></i> Remover
                                </button>
                            </div>
                        </div>
                    `}));const d=document.getElementById("requests-list");d&&(r.length===0?d.innerHTML=`
                        <div class="bg-secondary-dark/50 border border-dashed border-glass-border p-12 rounded-xl text-center col-span-full">
                            <i class="fas fa-inbox text-4xl text-text-muted mb-4"></i>
                            <p class="text-text-muted">Nenhuma solicitação encontrada.</p>
                        </div>
                    `:d.innerHTML=r.map(n=>`
                        <div class="bg-secondary-dark border border-glass-border p-6 rounded-xl relative hover:border-accent-cyan transition-colors group">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="font-heading font-bold text-xl text-white underline underline-offset-4 decoration-accent-cyan/30">${n.company}</h3>
                                    <p class="text-accent-cyan text-[10px] font-black uppercase tracking-widest mt-2 bg-accent-cyan/10 inline-block px-2 py-0.5 rounded">${n.cnpj}</p>
                                </div>
                                <button onclick="handleDeleteRequest('${n.id}')" class="text-text-muted hover:text-red-500 transition-colors p-2 bg-glass-bg rounded-lg">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-6">
                                <div class="bg-primary-dark/50 p-3 rounded-lg border border-glass-border">
                                    <span class="block text-accent-cyan text-[9px] uppercase font-black tracking-tighter mb-1 opacity-70">Responsável</span>
                                    <p class="text-white font-bold">${n.name}</p>
                                    <p class="text-text-muted text-xs font-medium">${n.role}</p>
                                </div>
                                <div class="bg-primary-dark/50 p-3 rounded-lg border border-glass-border">
                                    <span class="block text-accent-cyan text-[9px] uppercase font-black tracking-tighter mb-1 opacity-70">Contato</span>
                                    <p class="text-white font-bold">${n.phone}</p>
                                    <a href="https://wa.me/55${n.phone.replace(/\D/g,"")}" target="_blank" 
                                        class="flex items-center gap-2 mt-2 text-green-400 hover:text-green-300 text-xs font-bold uppercase">
                                        <i class="fab fa-whatsapp"></i> Chamar
                                    </a>
                                </div>
                            </div>
                            <div class="bg-primary-dark/50 p-4 rounded-lg border border-glass-border mt-auto">
                                <span class="block text-accent-cyan text-[9px] uppercase font-black tracking-tighter mb-2 opacity-70">Mensagem</span>
                                <p class="text-text-muted text-sm italic leading-relaxed">"${n.message}"</p>
                            </div>
                        </div>
                    `).join(""))}static showPartnerForm(){document.getElementById("view-partners-list").classList.add("hidden"),document.getElementById("view-partners-form").classList.remove("hidden"),document.getElementById("partner-form-title").innerText="Novo Parceiro",document.getElementById("partner-form").reset()}static showPartnerList(){document.getElementById("view-partners-form").classList.add("hidden"),document.getElementById("view-partners-list").classList.remove("hidden")}static showServiceForm(e=!0){document.getElementById("view-services-list").classList.add("hidden"),document.getElementById("view-services-form").classList.remove("hidden"),e&&(document.getElementById("service-form-title").innerHTML='<span class="w-1 h-8 bg-accent-cyan rounded-full"></span> Novo Serviço',document.getElementById("service-form").reset(),document.getElementById("service-content-raw").value="",document.getElementById("service-content-preview").innerText="(O conteúdo aparecerá aqui após a edição...)",this.editingServiceId=null,this.editingGallery=[])}static showServiceList(){document.getElementById("view-services-form").classList.add("hidden"),document.getElementById("view-services-list").classList.remove("hidden")}static showDirectorForm(e=!0){document.getElementById("view-directors-list").classList.add("hidden"),document.getElementById("view-directors-form").classList.remove("hidden"),e&&(document.getElementById("director-form-title").innerText="Novo Diretor",document.getElementById("director-form").reset(),document.getElementById("director-preview-img").src="assets/avatar_placeholder.png",document.getElementById("director-img").value="")}static showDirectorList(){document.getElementById("view-directors-form").classList.add("hidden"),document.getElementById("view-directors-list").classList.remove("hidden")}static async deleteNews(e){confirm("Tem certeza que deseja excluir esta notícia?")&&(await c.deleteNews(e),this.loadData())}static async deletePartner(e){confirm("Tem certeza que deseja excluir este parceiro?")&&(await c.deletePartner(e),this.loadData())}static async deleteService(e){confirm("Tem certeza que deseja excluir este serviço?")&&(await c.deleteService(e),this.loadData())}static async deleteDirector(e){confirm("Tem certeza que deseja excluir este diretor?")&&(await c.deleteDirector(e),this.loadData())}static async handleAddNews(e){e.preventDefault();const i=e.target.querySelector('button[type="submit"]'),t=i.innerHTML;i.innerHTML='<i class="fas fa-spinner fa-spin"></i> Salvando...',i.disabled=!0;try{const s=document.getElementById("news-file");let a=document.getElementById("news-img").value;if(s.files&&s.files[0])try{a=await this.readFileAsBase64(s.files[0])}catch(g){console.error("Error reading file",g),alert("Erro ao ler arquivo de imagem.");return}else!a&&!this.editingNewsId&&(a="assets/news-placeholder.jpg");let o=[...this.editingNewsGallery];const m=document.getElementById("news-gallery-urls");if(m&&m.value){const g=m.value.split(",").map(u=>u.trim()).filter(u=>u);o=[...o,...g]}const l=document.getElementById("news-gallery-files");if(l&&l.files&&l.files.length>0)for(let g=0;g<l.files.length;g++)try{const u=await this.readFileAsBase64(l.files[g]);o.push(u)}catch(u){console.error("Error reading gallery file",u)}const d=this.newsInlineEditor?this.newsInlineEditor.root.innerHTML:"",n={title:document.getElementById("news-title").value,news_date:document.getElementById("news-date").value,img:a,content:d,gallery:o};this.editingNewsId?(await c.updateNews(this.editingNewsId,n),alert("Notícia Atualizada!")):(await c.addNews(n),alert("Notícia Publicada!")),this.loadData(),this.showNewsList()}catch(s){console.error(s),alert("Erro ao salvar notícia: "+s.message)}finally{i.innerHTML=t,i.disabled=!1}}static async handleAddPartner(e){e.preventDefault();const i={name:document.getElementById("partner-name").value,logo:document.getElementById("partner-logo-url").value,description:document.getElementById("partner-desc").value,video_url:document.getElementById("partner-video").value};try{await c.addPartner(i),this.loadData(),this.showPartnerList(),e.target.reset()}catch(t){console.error(t),alert("Erro: "+t.message)}}static async editNews(e){const t=(await c.getNews()).find(s=>s.id===e);if(!t){alert("Erro: Notícia não encontrada.");return}this.editingNewsId=e,document.getElementById("news-title").value=t.title,document.getElementById("news-date").value=t.news_date,document.getElementById("news-img").value=t.img||"",this.newsInlineEditor&&this.newsInlineEditor.clipboard.dangerouslyPasteHTML(t.content||""),this.editingNewsGallery=t.gallery||[],this.renderNewsGalleryPreview(),this.showNewsForm()}static renderNewsGalleryPreview(){const e=document.getElementById("news-gallery-preview");e&&(e.innerHTML=this.editingNewsGallery.map((i,t)=>`
            <div class="relative w-16 h-16 rounded border border-glass-border overflow-hidden bg-white/5 group">
                <img src="${i}" class="w-full h-full object-cover">
                <button type="button" onclick="window.removeNewsGalleryItem(${t})" class="absolute inset-0 bg-red-500/80 text-white opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `).join(""),this.editingNewsGallery.length===0&&(e.innerHTML='<p class="text-text-muted text-[10px] uppercase tracking-widest italic">Nenhuma foto na galeria</p>'))}static removeNewsGalleryItem(e){this.editingNewsGallery.splice(e,1),this.renderNewsGalleryPreview()}static async handleAddPartner(e){e.preventDefault(),console.log("Adding partner...");const i=document.getElementById("partner-file");let s=document.getElementById("partner-logo").value;if(i.files&&i.files[0]){console.log("Reading file:",i.files[0].name);try{s=await this.readFileAsBase64(i.files[0]),console.log("File read success, base64 length:",s.length)}catch(a){console.error("Error reading file",a),alert("Erro ao ler a imagem! Tente outro arquivo.");return}}if(!s&&!document.getElementById("partner-name").value){alert("Preencha pelo menos o nome!");return}const r={name:document.getElementById("partner-name").value,description:document.getElementById("partner-desc").value,video_url:document.getElementById("partner-video").value,logo:s};try{await c.addPartner(r),console.log("Partner added to storage"),alert("Parceiro Adicionado com Sucesso!"),this.loadData(),e.target.reset()}catch(a){console.error(a),alert("Erro ao salvar: "+a.message)}}static async handleAddService(e){e.preventDefault();const i=document.getElementById("editing-service-id").value,t=document.getElementById("service-file");let r=document.getElementById("service-img").value;if(t.files&&t.files[0])try{r=await this.readFileAsBase64(t.files[0])}catch(d){console.error("Error reading file",d);return}let a=[...this.editingGallery];const o=document.getElementById("service-gallery-urls");if(o.value){const d=o.value.split(",").map(n=>n.trim()).filter(n=>n);a=[...a,...d]}const m=document.getElementById("service-gallery-files");if(m.files&&m.files.length>0)for(let d=0;d<m.files.length;d++)try{const n=await this.readFileAsBase64(m.files[d]);a.push(n)}catch(n){console.error("Error reading gallery file",n)}const l={title:document.getElementById("service-title").value,description:document.getElementById("service-desc").value,full_description:document.getElementById("service-content-raw").value,image:r,gallery:a};i?(await c.updateService(i,l),alert("Serviço Atualizado!")):(await c.addService(l),alert("Serviço Adicionado!")),this.loadData(),e.target.reset(),document.getElementById("service-content-raw").value="",document.getElementById("service-content-preview").innerText="(O conteúdo aparecerá aqui após a edição...)",document.getElementById("service-content-preview").classList.add("opacity-70","italic"),this.editingGallery=[],this.renderGalleryPreview(),document.getElementById("editing-service-id").value="",this.showServiceList()}static async editService(e){const t=(await c.getServices()).find(o=>o.id===e);if(!t)return;document.getElementById("editing-service-id").value=t.id,document.getElementById("service-title").value=t.title,document.getElementById("service-desc").value=t.description;const s=t.full_description||"";document.getElementById("service-content-raw").value=s;const r=document.createElement("div");r.innerHTML=s;const a=r.textContent||r.innerText||"";document.getElementById("service-content-preview").innerText=a.substring(0,150)+(a.length>150?"...":""),document.getElementById("service-content-preview").classList.remove("opacity-70","italic"),document.getElementById("service-img").value=t.image.startsWith("data:")?"":t.image,document.getElementById("service-gallery-urls").value="",this.editingGallery=t.gallery?[...t.gallery]:[],this.renderGalleryPreview(),document.getElementById("service-form-title").innerHTML='<span class="w-1 h-6 bg-accent-cyan rounded-full"></span> Editar Serviço',this.showServiceForm(!1)}static renderGalleryPreview(){const e=document.getElementById("service-gallery-preview");e&&(e.innerHTML=this.editingGallery.map((i,t)=>`
            <div class="relative w-16 h-16 rounded border border-glass-border overflow-hidden bg-white/5 group">
                <img src="${i}" class="w-full h-full object-cover">
                <button type="button" onclick="window.removeServiceGalleryItem(${t})" class="absolute inset-0 bg-red-500/80 text-white opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        `).join(""),this.editingGallery.length===0&&(e.innerHTML='<p class="text-text-muted text-[10px] uppercase tracking-widest italic">Nenhuma foto na galeria</p>'))}static removeServiceGalleryItem(e){this.editingGallery.splice(e,1),this.renderGalleryPreview()}static async handleAddDirector(e){e.preventDefault();const i=document.getElementById("director-file"),t=document.getElementById("director-img");let s=t?t.value:"";if(i.files&&i.files[0])try{s=await this.readFileAsBase64(i.files[0])}catch(o){console.error("Error reading file",o);return}const r=document.getElementById("editing-director-id").value,a={name:document.getElementById("director-name").value,role:document.getElementById("director-role").value,company:document.getElementById("director-company").value,image:s};try{r?(await c.updateDirector(r,a),alert("Diretor Atualizado!")):(await c.addDirector(a),alert("Diretor Adicionado!")),this.loadData(),e.target.reset(),document.getElementById("director-img").value="",document.getElementById("editing-director-id").value="",this.showDirectorList()}catch(o){console.error(o),alert("Erro: "+o.message)}}static async editDirector(e){const t=(await c.getDirectors()).find(r=>r.id===e);if(!t)return;document.getElementById("editing-director-id").value=t.id,document.getElementById("director-name").value=t.name,document.getElementById("director-role").value=t.role,document.getElementById("director-company").value=t.company||"",document.getElementById("director-img").value=t.image||"",document.getElementById("director-img").value=t.image||"";const s=document.getElementById("director-preview-img");s&&(s.src=t.image||"assets/avatar_placeholder.png"),this.showDirectorForm(!1),document.getElementById("director-form-title").innerText="Editar Membro"}static async handleDeleteRequest(e){confirm("Deseja excluir esta solicitação?")&&(await c.deleteRequest(e),this.loadData())}}v(p,"currentEditorTarget",null),v(p,"currentPreviewTarget",null),v(p,"editingNewsGallery",[]),v(p,"editingGallery",[]);document.addEventListener("DOMContentLoaded",()=>{try{console.log("AdminUI: Booting initialization..."),console.log("AdminUI: Booting initialization..."),p.init(),console.log("AdminUI: Initialization complete.")}catch(h){console.error("AdminUI: Fatal Init Error:",h),alert("Erro fatal ao iniciar AdminUI: "+h.message)}});
